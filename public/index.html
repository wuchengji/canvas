<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>canvas</title>
    <style>
      * {
        margin: 0;
        padding: 0;
      }
    </style>
  </head>
  <body>
    <canvas id="canvas" width="1000" height="500" style="border: 1px solid #ccc;" />
  </body>
  <script>
    // 鼠标事件
    window.tools = {};
    window.tools.getMouse = function (element) {
      var mouse = { x: 0, y: 0 };
      element.addEventListener("mousemove", function (e) {
        var x, y;
        var e = e || window.event;
        if (e.pageX || e.pageY) {
          x = e.pageX;
          y = e.pageY;
        } else {
          x =
            e.clientX +
            document.body.scrollLeft +
            document.documentElement.scrollLeft;
          y =
            e.clientY +
            document.body.scrollTop +
            document.documentElement.scrollTop;
        }
        x -= element.offsetLeft;
        y -= element.offsetTop;
        mouse.x = x;
        mouse.y = y;
      });
      return mouse;
    };
    // 键盘事件
    window.tools.getKey = function () {
      var key = {};
      window.addEventListener(
        "keydown",
        function (e) {
          if (e.keyCode == 38 || e.keyCode == 87) {
            key.direction = "up";
          } else if (e.keyCode == 39 || e.keyCode == 68) {
            key.direction = "right";
          } else if (e.keyCode == 40 || e.keyCode == 83) {
            key.direction = "down";
          } else if (e.keyCode == 37 || e.keyCode == 65) {
            key.direction = "left";
          } else {
            key.direction = "";
          }
        },
        false
      );
      return key;
    };
    // 动画
    window.requestAnimationFrame =
      window.webkitRequestAnimationFrame ||
      window.mozRequestAnimationFrame ||
      window.msRequestAnimationFrame ||
      window.oRequestAnimationFrame ||
      function (callback) {
        return window.setTimeout(callback, 1000 / 60);
      };
  </script>
</html>
